
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Curve Parser</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script>


    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div class="wrapper">
        <header>
            <h1>Curve Parser</h1>
        </header>
        <section id="main-content">
            <h3>
            <button onclick="send()" id="message_button">send message</button>
            <p>Message:</p>
            <div id="results"></div>
            <br/>

            <script>
                var iframeSource = 'curveParser.html';
                var parser = document.createElement('iframe');
                parser.setAttribute('src', iframeSource);
                parser.setAttribute('id', 'cParser');
                parser.style.width = 2000 + 'px';
                parser.style.height = 1000 +'px';
                document.getElementById('main-content').appendChild(parser);

                let fromServer = {
                    "lofunc": [
                        963853.9170467034,
                        781118.8270467035,
                        702662.5937133702,
                        573406.7803800369,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        563185.9562616078,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87,
                        501814.87
                    ],
                    "func": [
                        1619398.24,
                        1436663.1500000001,
                        1358206.9166666667,
                        1228951.1033333335,
                        924063.415,
                        823893.316,
                        794638.248,
                        949709.314,
                        1281179.326,
                        743175.166,
                        1050709.298,
                        805678.288,
                        846126.3359999999,
                        977729.9439999999,
                        1140587.566,
                        942094.8699999999,
                        1071734.8699999999,
                        1082322.884,
                        1057810.6240000003
                    ],
                    "hifunc": [
                        1814929.97,
                        1814929.97,
                        1814929.97,
                        1814929.97,
                        1579607.7379532966,
                        1541886.6857383922,
                        1512631.6177383922,
                        1667702.683738392,
                        1814929.97,
                        1461168.535738392,
                        1768702.667738392,
                        1523671.657738392,
                        1564119.705738392,
                        1695723.313738392,
                        1814929.97,
                        1660088.239738392,
                        1789728.239738392,
                        1800316.2537383921,
                        1775803.9937383924
                    ],
                    "minValue": 501814.87,
                    "maxValue": 1814929.97,
                    "title": "Price vs. Average Weekly Number of Sold Avocados",
                    "xlabel": "Price ($)",
                    "ylabel": "Average Weekly Num of Sold Avocados",
                    "xVals": [
                        "$1.15 - $1.20",
                        "$1.20 - $1.25",
                        "$1.25 - $1.30",
                        "$1.30 - $1.35",
                        "$1.35 - $1.40",
                        "$1.40 - $1.45",
                        "$1.45 - $1.50",
                        "$1.50 - $1.55",
                        "$1.55 - $1.60",
                        "$1.60 - $1.65",
                        "$1.65 - $1.70",
                        "$1.70 - $1.75",
                        "$1.75 - $1.80",
                        "$1.80 - $1.85",
                        "$1.85 - $1.90",
                        "$1.90 - $1.95",
                        "$1.95 - $2.00",
                        "$2.00 - $2.05",
                        "$2.05 - $2.10"
                    ],
                    "zetaScore": 0,
                    "nonKPSamp": 100,
                    "sampCount": [
                        6,
                        6,
                        6,
                        6,
                        6,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5,
                        5
                    ]
                }

                // To pass argument(s) to curveParser, stringify them
                // and replace yuh with your string.
                // parser.contentWindow.postMessage('yuh', '*');
                let args = JSON.stringify(fromServer);
                parser.contentWindow.postMessage(args, '*');

                function send()
                {
                    parser.contentWindow.postMessage('the message: ', '*');
                }

                function bindEvent(element, eventName, eventHandler)
                {
                    if (element.addEventListener)
                    {
                        element.addEventListener(eventName, eventHandler, false);
                    } else if (element.attachEvent) {
                        element.attachEvent('on' + eventName, eventHandler);
                    }
                }

                // Listen to message from child window
                bindEvent(window, 'message', function (e) {
                    console.log("bind event was called");
                    // let normalizedCoords = JSON.stringify(normCoords(JSON.parse(e.data)));
                    // results.innerHTML = normalizedCoords;
                    // results.innerHTML = e.data;
                    // drawnLine is a global.
                    // drawnLine = normalizedCoords;
                    console.log("this, from stepDad: ", this);
                });
            </script>

        </section>
    </div>

</body>
</html>
